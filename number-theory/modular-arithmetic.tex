\section{Modular Arithmetic}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Divisibility}

Rosen's "Discrete Mathematics and its Applications"'s chapter 4 along with Gallian's "Contemporary
Abstract Algebra" chapter 0 make great references for this material.
\\

An $a \neq 0 \in \mathbb{Z}$ is called a \textbf{divisor}
of a $b \in \mathbb{Z}$
if there is a $c\in\mathbb{Z}$, such that $b = ac$.
We write $a|b$, "a divides b". We also commonly say that "b is a multiple of a".

Note that this working definition means that $a|b$ is an integer.
So for example, $3\not| 7$ since $7 / 3 \notin \mathbb{Z}$ but $3|12$ since $12/3 \in \mathbb{Z}$.
\\

If $n$ and $d$ are positive integers, how many positive integers not exceeding $n$ are divisible by $d$?

In order to be divisible by $d$, an integer must be of the form $dk$, for some integer $k>0$.
So the integers divisible by $d$ and not greater than $n$ are the integers with $k$ such that
$0 \leq dk < n$
or $0 < k < n/d$.
Thus, the number of integers divisible by $d$, not exceeding $n$, is $\lfloor n / d \rfloor$.
\\~\\


\subsubsection{Properties of Divisibility of Integers}

\begin{enumerate}
    \item If $a|b$ and $a|c$, then $a|(b+c)$ and $a|(b-c)$. \label{divisibility:p1}
    \item If $a|b$, then $a|bc$ for all $c\in\mathbb{Z}$. \label{divisibility:p2}
    \item If $a|b$ and $b|c$, then $a|c$ (transitivity).
\end{enumerate}


To prove the first statement, use the fact that $a|b$ means that $b = as$,
$a|c$ means that $c=at$,
and $b+c = a(s+t)$.
Hence $a|(b+c)$.
(Closure under addition of integers.)
Since the integers form a ring, $b-c = a(s-t)$, where $s-t \in \mathbb{Z}$.

To prove the second statement, use the fact that $a|b$ means $b = as$, so $b\times c = as \times c$.
(Closure under multiplication of integers.)

To prove the last statement, use $b = as$, $c = bt$. Then $c = bt = ast$ and hence $a|c$.

\textbf{Corollary:}
If $a. b, c \in \mathbb{Z}$, where $a \neq 0$,and $a|b$ and $a|c$, then $a|mb + nc$ whenever $m, n \in \mathbb{Z}$.

Use if $a|b$ and $a|c$, then $a|(b+c)$ and if $a|b$, then $a|bc$,
for $c \in \mathbb{Z}$, to prove it.
\\~\\


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Division Algorithm}

\begin{itemize}
\item If $a = bq + r$ where $0 \leq r < b$ and $b>0$
\item $q = a \bdiv b = \lfloor a/b \rfloor$ (quotient)
\item $r = a \pmod b = a - bq$ (remainder)
\end{itemize}

For example, when 101 is divided by 11, $11|101$
$$
101 = 11 \cdot 9 + 2
$$

When -11 is divided by 3, $3|-11$
$$
-11 = 3 \cdot -4 + 1
$$
Note how we are multiplying $3\cdot -4$. This is so that our remainder, $r$, mets the criteria
of $0 \leq r < b$.
\\~\\

In Gallian's "Contemporary Abstract Algebra", the division algorithm is stated as follows:
let $a$ and $b$ be integers with $b>0$.
Then there exists unique integers $q$ and $r$ with the propperty that
$a = bq +r$ and $0 \leq r < b$.
\\

The proof begins with the existence portion of the theorem where it considers a set
$S = \{ a - bk : k\in\mathbb{Z}, a - bk \geq 0 \}$.

If $0\in S$, then $b$ divides $a$ ($b|a$), and so $q = a/b$ and $r=0$.

If we assume $0\notin S$ ($b\not| a$), then we will also need to investigate whether $S$ is empty or not.
But we can quickly come up with a cases to see that $S \neq \emptyset$ if we assume $0\notin S$:
\begin{enumerate}
    \item $a>0$: if $k=0$, $a - bk = a\geq 0$.
    \item $a<0$: if $k = 2a$, then $a - bk = a - b(2a) \geq 0$.
    \item $a=0$: here technically we could have some $k<0$ so that $a - bk = -b(-|k|) \geq 0$. However,
    in the context of $\lfloor a/b \rfloor$, which is the operation we want to evaluate, this gives us a very
    trivial case $\lfloor a/b \rfloor = 0$ and it reduce our initial problem to $r = bk$ (except we still haven't
    introduced $r$), which is our initial definition of divisibility.
\end{enumerate}
Going through all the possible cases leads us to believe that $S\not \emptyset$
so we can apply the \textbf{well ordering principle} which states that every non-empty set of positive
integers contains a smallest members.
We will call this smallest member of $S$ $r = a - bq$ ($a = bp + r$).
This construction of $r$ also tells us that $0 \leq r$, so now we need to prove that $r < b$ and the
uniqueness of $r$ and $q$ (we just proved their existence).

To prove that $b < r$, let's try a proof by contradiction.
Assume $r \geq b$, we already know that $a - bq \in S$ is supposed to be the smallest positive integer of our set,
so let's look at the next one which is $a - b(q+1) = a - bq - b = r - b \geq 0$ (we used our assumption of
$r \geq b$ in the last step).
However, $a - b(q+1) < a - bq$, wich leads us to a contradiciton, so we need $r < b$ to have a consistent
convention.
Let's finally move to proving the uniqueness of $q$ and $r$.

Let's do another proof by contradition.
Let's say we have $a = bq + r$, where $0 \leq r < b$ and $a = bq^\prime + r^\prime$, where $0 \leq r^\prime < b$.
For convenience, suppose $r^\prime \geq r$.
Then $bq + r = bq^\prime + r^\prime$ and $b(q - q^\prime) = r^\prime -r$.
The last expression meands that $b$ divides $r^\prime - r$ ($b | r^\prime-r$), then $r^\prime-r = bu$ for some $u\in\mathbb{Z}$.
Also, since $r^\prime \geq r$, then $0 \leq r^\prime - r < r \leq r^\prime < b$.
To reach the conclusion we need to look back: if $r^\prime - r$ were a non-zero positive integer, then it would mean
that $q - q^\prime$ is also a non-zero integer, so that $bq \neq bq^\prime$, and thus either $r$ or $r^\prime$ would not be the
smallest member of $S$. But if $r^\prime - r = 0$, then we achieve consistency all around.



\subsection{Congruences}

If $a$ and $b$ are congruent modulo $m$ ($a,b \in \mathbb{Z}, m >0$), $a \equiv b \pmod m$,
if $m$ divides $a-b$ (written another way, $m | a-b$).
\\

The above does not yet tell is much, there is another theorem we need:
let $a, b, m\in\mathbb{Z}$ and $m \geq 0$.
Then $a \equiv b \pmod m$ if and only if $a \bmod m = b \bmod m$
(\textbf{if the remainders are equal!}).

Another way of seeing it is that $a$ and $b$ have the same remainder when divided by $m$, goes as follows:
If $m$ divides $a-b$, then $a-b = mc$ for some $c \in\mathbb{Z}$.
If both $a$ and $b$ have the same remainders when divided by $m$, then
$r = a - mq$ and $r = b - mp$.
In turn $a-b = (mq - r) - (mp - r) = mq - mp = m(q-p) = mc$ (we have consistency once again).

The above also means that
$$
a \equiv b \pmod m  \leftrightarrow  a \bmod m = b \bmod m  \leftrightarrow  a = b + mc
$$

The thing to keep in mind is that congruences are binary relations: is $17 \equiv 5 \pmod 6$? yes, because $6|17-5$ ($17R5$).
Does $6|17-6$? No, so $17 \not\equiv 6 \pmod 6$ ($17\cancel{R}6$).
Whereas the other two equivalences give us ways to compute and further understand the relation.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Modular Arithmetic}

If $a \equiv b \pmod m$ and $c \equiv d \pmod m$, then
\begin{equation}
    a + c \equiv b + d \pmod m
\end{equation}

and
\begin{equation}
    ac \equiv bd \pmod m
\end{equation}

To prove these, you can use something like the following reasoning:

$a - b = mp$ and $c - d = mq$.
Adding these two, we get $a + c - (b + d) = m(p+q)$.

For the second one, since $c = d + mq$
$$
ac = (b + mp)(d + mq) = bd + bmq + dmp + mmpq = bd + mc
$$

\textbf{Corollary detailing more forms of addition and multiplication}

\begin{equation}
    (a+b) \bmod m = [(a \bmod m) + (b \bmod m)] \bmod m
\end{equation}

To show this,
$a = mk + r = mk + (a \bmod m)$ hence
$a \equiv (a \bmod m) \pmod m$ ($a$ and $a \bmod m$ are congruent).
Similarly, $b \equiv (b \bmod m) \pmod m$ ($b$ and $b \bmod m$ are congruent)
So $a + b \equiv [(a \bmod m) + (b \bmod m)] \pmod m$.

Because $a \equiv b \pmod m$ implies $a \bmod m = b \bmod m$, the above can be written as
$(a+b) \bmod = [(a \bmod m) + (b \bmod m)] \pmod m$.

\begin{equation}
    ab \bmod m = [(a \bmod m)(b \bmod m)] \bmod m
\end{equation}

Following a similar logic as in the above proof, we can obtain the former equation by using $ab \equiv [(a \bmod m)(b \bmod m)] \bmod m$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Arithmetic Module $m$}

The reason for the above complexities is because it just so happens that it is useful and informational
to define arithmetic operations on the set of non-negative integers less than $m$ because they form
a \textbf{commutative ring} which we denote as $\mathbb{Z}_m$.

For example, addition in $\mathbb{Z}_m$, looks like
$$
a + b = (a+b) \bmod m
$$
And in the previous subsection we saw an algorithm to crank out the result.

Similarly, multiplication in $\mathbb{Z}_m$, looks like,
$$
ab = (ab) \bmod m
$$

\textbf{Note:} the reason we mentioned that $\mathbb{Z}_m$ is a commutative ring is to help you remember that
multiplicative inverses don't always exist in $\mathbb{Z}_m$.
\\

Also, note that these definitions of additiona and multiplication are equivalent to
$a + b \equiv c+d \pmod m$ and $ac \equiv dc \pmod m$.
For example, the multiplicative inverse can be written as $ab = ab \bmod m = 1$ or $ab \equiv 1 \pmod m$
and the additive inverse can be written as $a+b = (a+b) \bmod = 0$ or as $a+b \equiv 0 \pmod m$.
\\~\\

It is worth expanding on why we have a ring and why the multiplicative inverse may sometimes not exist
in a ring based on modular arithmetic.

We are essentially looking for a number $b$ such that when a given $a$ is multiplied by it, the result will be one,
$ab = ab \bmod m = 1$ or $ab \equiv 1 \pmod m$.

First, let's see a case where it does not exist, $2 \bmod 6$:
\begin{itemize}
    \item $2\cdot 0 = 0 \bmod 6 = 0$
    \item $2\cdot 1 = 2 \bmod 6 = 2$
    \item $2\cdot 2 = 4 \bmod 6 = 4$
    \item $2\cdot 3 = 6 \bmod 6 = 0$
    \item $2\cdot 4 = 8 \bmod 6 = 2$
    \item $2\cdot 5 = 10\bmod 6 = 4$
    \item $2\cdot 6 = 12\bmod 6 = 0$
\end{itemize}
and so on.
Maybe this gives you a rough idea of what the issue maybe.
Let's look at our general formula $ab \bmod = 1$ once again.
We know that this formula implies that $ab = mk + 1$ or $ab - mk = 1$.
This last expression tells us that in order to get a multiplicative inverse we need to be able to add to Products
of integers in such a way as to end up with a sum of one (hard to do that when you are dealing with 2 even numbers such as 2 and 6).




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Primes and Greates Common Divisors}

\textbf{Theorem} if $n$ is a composite integer, then $n$ has a prime divisor less than or equal to $\sqrt{n}$.

The proof is by contradiction: if $n$ is composite, then $n = ab$. The negation of one prime divisior
less than or equal to $\sqrt{n}$ means that all divisors are greater than $\sqrt{n}$, which means
$n = ab > \sqrt{n}^2 = n$, leading to a contradition.
\\


\textbf{The prime number theorem} the ratio fo the number of primes not exceeding $x$ and $x / \ln(x)$ approaches 1
as $x$ grows without bound.

The theorem was first proved by Jacques Hadamard and Charles-Jean-Gustave-Nicholas de la Valle-Poussin
in 1986 using the theory of complex variables.

The odds of randonly selecting a positive integer less than $n$ that is prime is approximately $(n / \ln(n)) / n = 1 / \ln(n)$.
\\~\\


\textbf{The greatest commmon divisor} let $a,b \in \mathbb{Z}$, not both zero.
The largest integer $d$ such that $d|a$ and $d|b$ is called the greatest common divisior or $a$ and $b$.

On the otherhand, the \textbf{least common multiple} is the smallest positive integer that is divisible by $a$ and $b$
($a|lcm$ and $b|lcm$).

A simple way to compute these two values is by looking at the prime factorization of two numbers $a$ and $b$,
$$
a = p^{a_1}_{1} p^{a^2}_{2} p^{a_3}_{3} \ldots p^{a_n}_{n}, \quad a = p^{b_1}_{1} p^{b^2}_{2} p^{b_3}_{3} \ldots p^{b_n}_{n}
$$
Then,
$$
gcd(a,b) = p^{\min(a_1, b_1)}_{1} p^{\min(a_2, b_2)}_{2} \ldots p^{\min(a_n, b_n)}_{n}
$$
and,
$$
lcm(a,b) = p^{\max(a_1, b_1)}_{1} p^{\max(a_2, b_2)}_{2} \ldots p^{\max(a_n, b_n)}_{n}
$$

From here we can also see that $ab = gcd(a,b) = lcm(a,b)$.
\\~\\


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{The Euclidean Algorithm}

Let's look for more efficient ways to find a greatest commmon divisor.
Let's say that we have an $a,b,d \in \mathbb{Z}$ and we want to find $d = \gcd(a,b)$.

So we first divide $a$ by $b$
$$
a = b\cdot q + r
$$

Note that if we rewrite the above a tad, we get $r = a - bq$.
By property (\ref{divisibility:p2}), if $d|b$, then $d|bq$.
Now the remainder is the difference of two integers whose divisor is $d$, this should make you think about
propoerty (\ref{divisibility:p1}) which says that if $d | (a - bq)$.
In other words, \textbf{the $d$ is also a divisor of the remainder $r$}.

\textbf{Note:} there is a very good argument describing this in chapter 3, section 7, starting on page 160 of
Data Structures with C++ using STL second edition by William Ford and William Topp.

Now, let's say that we had another common divisor, this time let's call it $e$.
If $e$ were a common divisor or $r$ and $b$, then $e$ would be a common divisor of $a$ as well
- propoerty (\ref{divisibility:p1}) and $a = bq + r$ together.
This means that $d = e$ or $\gcd(a,b) = \gcd(r,b)$.

One thing to note here is that this process works great when $a > b$.
In such a case, we keep replacing the largest of the two numbers by the remainder when dividing it by the other number.
This process keeps going until we reach the operation $\gcd(s,0)$.
In such a case, we are looking for an integer $x$, such that $0 = xt_1$ and $s = xt_2$.
Since the division algorithm requires $x>0$, then $x=s$ is the largest number dividing $0$ and $s$.

Finally, not that if $a=b$, then $\gcd(a,b) = \gcd(a,a) = \gcd(a,0) = a$, since the remainder of $a/a$ is zero.
And if $a < b$, then the remainder $a\%b = a$, so we are back to the previous instance of $\gcd(a,b) = \gcd(a,a) = \gcd(a,0) = a$


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Runtime of the Euclidean Algorithm}

The following is an addendum to a discussion in Section 1.2 "Divisibility and Greatest Common Divisors"
presented in "An introduction to mathematical Cryptography".

The claim presented is that the runtime of the Euclidean algorithm is $\log_2 (b) + b$, where $b$ is the smaller of the
two integers in $\gcd(a,b)$.

We know that the $r_i$ values are nondecreasing since the division algorithm guarantees us that
$0 \leq r_{i+1} < r_i$.
Then the claim we investigate is that after two iterations, the value of $r_i$ is at least cut in half:
$r_{i+2} \leq \frac{1}{2}r_i$.

Since our claim is about what happens every two iterations, we still want to investigate what happens every iteration,
which leaves us with the two cases of $r_{i+1} \leq \frac{1}{2}r_i$ and $r_{i+1} > \frac{1}{2}r_i$.
Both cases possible since we only have a guarantee that $0 \leq r_{i+1} < r_i$.
\\

For the case of $r_{i+1} \leq \frac{1}{2}r_i$, we would have $0 \leq r_{i+1} \leq \frac{1}{2}r_i < r_i$, based on the
division algorithmn and this specific case we are exploring.
Then on the next iteration, we would have $0 \leq r_{i+2} < r_{i+1}$, and when we our case we get
$0 \leq r_{i+2} \leq \frac{1}{2}r_{i+1} < r_{i+1} \leq \frac{1}{2}r_i < r_1$.
Which simplifies to what the book says, $0 \leq r_{i+2} < r_{i+1} \leq \frac{1}{2}r_i$.
\\

The argument for the second case is misleadingly clever.
Since $r_{i+1} > \frac{1}{2}r_i$, then we can only divide $r_i$ by $r_{i+1}$ no more than once,
that is, the quotien in $r_i = r_{i+1}\cdot q + r_{i+2}$ must be 2, otherwise $r_{i+2} > r_{i+2}$,
contradicting the division algorithm's promise that $0 \leq r_{i+1} < r_i$.